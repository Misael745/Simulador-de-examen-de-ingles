<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Bienvenido</title>
  <!-- Enlazar CSS externo -->
  <link rel="stylesheet" href="{{ url_for('static', filename='StyleIndex.css') }}">
</head>
<body>
  <!-- Header principal -->
  <header class="header">
    <h1>Dashboard de Exámenes</h1>
  </header>

  <!-- Navegación: botones de login / registro -->
  <nav>
    <a href="{{ url_for('login') }}" class="btn btn-primary">Iniciar sesión</a>
    <a href="{{ url_for('register') }}" class="btn btn-secondary">Registrar</a>
  </nav>

  <!-- Filtros de fecha y tipo -->
  <section class="filtros">
    Desde: <input type="date" id="startDate" value="{{ start_date }}">
    Hasta: <input type="date" id="endDate" value="{{ end_date }}">
    Tipo:
    <select id="typeFilter">
      <option value="todos" {% if tipo=='todos' %}selected{% endif %}>Todos</option>
      <option value="practica" {% if tipo=='practica' %}selected{% endif %}>Práctica</option>
      <option value="final" {% if tipo=='final' %}selected{% endif %}>Final</option>
    </select>
    <button onclick="filtrarYActualizar()">Filtrar</button>
  </section>

  <!-- Gráfica de puntuación en el tiempo -->
  <div class="grafico">
    <h2>Distribución de Puntuaciones</h2>
    <img src="data:image/png;base64,{{ chart_scores }}" alt="Histograma de Puntuaciones">
  </div>

  <!-- Histograma de porcentajes -->
  <div class="grafico">
    <h2>1. Histograma de Porcentajes</h2>
    <img src="data:image/png;base64,{{ chart_hist }}" alt="Histograma de Porcentajes">
  </div>

  <!-- Pastel de tipos de examen -->
  <div class="grafico">
    <h2>Distribución por Tipo de Examen</h2>
    <img src="data:image/png;base64,{{ chart_types }}" alt="Gráfico de Pastel de Tipos">
  </div>

  <!-- Histograma de exámenes por usuario -->
  <div class="grafico">
    <h2>Exámenes por Usuario</h2>
    <img src="data:image/png;base64,{{ chart_users }}" alt="Histograma Exámenes por Usuario">
  </div>

  <!-- Barras de promedio por tipo -->
  <div class="grafico">
    <h2>3. Promedio por Tipo de Examen</h2>
    <img src="data:image/png;base64,{{ chart_avgtype }}" alt="Promedio por Tipo de Examen">
  </div>

  <!-- Pie de niveles -->
  <div class="grafico">
    <h2>4. Distribución de Niveles</h2>
    <img src="data:image/png;base64,{{ chart_pie }}" alt="Distribución de Niveles">
  </div>

  <!-- Script de filtro -->
  <script>
    function filtrarYActualizar() {
      const start = document.getElementById('startDate').value;
      const end   = document.getElementById('endDate').value;
      const type  = document.getElementById('typeFilter').value;
      const params = new URLSearchParams();
      if (start) params.set('start_date', start);
      if (end)   params.set('end_date', end);
      if (type)  params.set('tipo', type);
      window.location.search = params.toString();
    }
  </script>
</body>
</html>
